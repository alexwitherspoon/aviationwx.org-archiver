# AviationWX.org Archiver - Example Configuration
#
# Config lives in the config_data named volume. Edit via web GUI or override
# with ARCHIVER_* env vars (see README).

# ============================================================
# Archive Settings
# ============================================================
archive:
  # Where archived images are saved. Docker: ./archive bind-mounted here.
  output_dir: /archive

  # Layout: output_dir/AIRPORT/metadata.json + YYYY/MM/DD/camera_name/filename (0o644)

  # Retention days (0 = unlimited)
  retention_days: 0      # Days to keep (0 = unlimited)
  retention_max_gb: 0    # Max archive size in GB, oldest removed first (0 = unlimited)

# ============================================================
# Fetch Schedule
# ============================================================
schedule:
  # Fetch interval (minutes)
  interval_minutes: 15

  # Run fetch immediately on startup
  fetch_on_start: true

  # Max minutes per run; next run resumes from where it stopped.
  job_timeout_minutes: 30

# ============================================================
# AviationWX.org Source
# ============================================================
source:
  # Base URL of the AviationWX.org platform
  base_url: https://aviationwx.org

  # Public API endpoint for airport list
  airports_api_url: https://api.aviationwx.org/v1/airports

  # Partner API key (optional): 500/min vs 100/min anonymous. Get at aviationwx.org.
  # api_key: ""

  # Request timeout (seconds)
  request_timeout: 30

  # Retries and delay between retries
  max_retries: 3
  retry_delay: 5

  # History API: fetch all frames, download only missing. When false: one image per webcam per run.
  use_history_api: true

  # Fallback delay (seconds) when rate-limit probe fails. Otherwise auto-detected from
  # X-RateLimit-Limit: 50% of partner limit (with key) or anonymous limit (without).
  request_delay_seconds: 1.2

# ============================================================
# Airports to Archive
# ============================================================
airports:
  # Archive all airports when true; otherwise use selected list.
  archive_all: false

  # Airport codes (ICAO/FAA). Used only when archive_all is false.
  selected:
    - KSPB
    - KAWO

# ============================================================
# Web GUI
# ============================================================
web:
  # Set to false in secure environments where the GUI should not run
  enabled: true

  # Web GUI port
  port: 8080

  # Bind address (0.0.0.0 = all interfaces)
  host: 0.0.0.0

  # Log entries shown on dashboard
  log_display_count: 100

  # When > 0: archive worker yields this many seconds at strategic points so
  # the web UI stays responsive during runs. 0 = disabled. Default 0.02.
  # priority_yield_seconds: 0.02

# ============================================================
# Logging
# ============================================================
logging:
  # Log level: DEBUG, INFO, WARNING, ERROR
  level: INFO

  # Log file path (empty = stdout only)
  file: ""
